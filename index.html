<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <!--<script src="https://raw.githubusercontent.com/toncenter/tonweb/70894568b6c07af8d2c8ea8c1792605f8e9b9052/dist/tonweb.js"></script>-->
    <script type="text/javascript" src="https://wallet.ton.org/libs/tonweb.min.js?v=1.1.41"></script>
    <script type="text/javascript" src="https://wallet.ton.org/libs/tonweb-mnemonic.min.js?v=1.1.41"></script>
    <style>
      body {
        font-family: Roboto;
      }
    </style>
  </head>
  <body>
    <h1>Explored contracts:</h1>
    <div id="explored"></div>
    
    <script defer>
      let $ = document.querySelector.bind(document);
      let tonweb = new TonWeb(
        new TonWeb.HttpProvider(
          'https://testnet.toncenter.com/api/v2/jsonRPC',
          {apiKey: 'f6f4bb2f18a192ae0e1c1d40801c9e6fbef06ca8ab6c275e3f6165d3db77dc03'}
        )
      );
      
      let timer_root = new tonweb.Address('-1:1510202200000000000000000000000000000000000000000000000000000000');
      
      async function explore(addr, cache) {
        if (cache[addr]) {return [];}
        cache[addr] = true;
        
        let bell_data = await tonweb.call(addr, 'get_bell_data', []);
        console.debug(bell_data);
        
        if (bell_data.exit_code == 0) {
          return [addr.toString(true) + ': ' + bell_data.stack];
        } else {
          return [addr.toString(true) + ': get-method failed: ' + bell_data];
        }
      }
      
      (async () => {
        $('#explored').innerText = (await explore(timer_root, {})).join('\n');
      })();
    </script>
  </body>
</html>